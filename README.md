# Описание проекта

Проект состоит из двух сервисов:
- `task3-service`: легкий API на фласке который делает запрос на внешний сервис `http://my-nginx.mesh-external.svc.cluster.local` через `egress` c поддержкой mTLS и возрващает статус код запроса;
- `my-nginx`: второй сервис который для первого является внешним, т.к. создан в новом namespace `mesh-external`, и принимает только mTLS трафик. По сути является самым обычным nginx который показывает домашнюю станицу.

# Запуск проекта:
- при необходимости (для создания кластера локально) запустите команду: <code>$ minikube start --driver=docker --memory=4096</code>
- зайдите в папку `kube/` и запустите `./run.sh`
- во время исполнения, скрипт попросит ввести пароль пользователя для создания тоннеля на `minikube`
- откройте новое окно терминала в том же директории и запустите скрипт `./query.sh` чтобы сделать запрос на построенный сервис
- или введите команду <code>$ kubectl get service istio-ingressgateway -n istio-system</code> и скопируйте IP из колонки `EXTERNAL-IP`
- чтобы сделать запрос к сервису нужно ввести URL `<EXTERNAL-IP>/test` в браузере и получить результат
- чтобы почистить кластер локально можно в терминале из папки `kube/` запустить `./clear_all.sh` и при необходимости ввести `$ minikube delete`.

![screen sample](res/screen.png)
